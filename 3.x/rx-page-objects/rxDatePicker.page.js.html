<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: rxDatePicker.page.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="jsdoc-custom.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: rxDatePicker.page.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>///&lt;reference path="../typings/globals/selenium-webdriver/index.d.ts"/>
///&lt;reference path="../typings/globals/node/index.d.ts"/>
///&lt;reference path="../typings/globals/lodash/index.d.ts"/>
///&lt;reference path="../typings/globals/moment-node/index.d.ts"/>
'use strict';
const moment = require('moment');
const _ = require('lodash');
const globals_1 = require('protractor/globals');
const rxComponent_1 = require('./rxComponent');
let rxSelect = require('./rxSelect.page').rxSelect;
/**
 * @class
 */
class rxDatePicker extends rxComponent_1.rxComponentElement {
    /**
     * @param {ElementFinder} [rxDatePickerElement=$('rx-date-picker')]
     * ElementFinder to be transformed into an rxDatePicker page object
     * @returns {rxDatePicker}
     */
    constructor(rxDatePickerElement) {
        if (!rxDatePickerElement) {
            rxDatePickerElement = globals_1.$$('rx-date-picker').first();
        }
        super(rxDatePickerElement);
        this.rootElement = rxDatePickerElement; // deprecate in 3.x
        this.tblCurrentMonthDays = this.$$('.day.inMonth');
        // Overrides
        this.isEnabled = () => {
            return this.getAttribute('disabled')
                .then((disabled) => !disabled);
        };
    }
    /**
     * @private
     * @type {String}
     * @description (get/set) Month value of the picker _calendar_.
     * **Format:** `MM` (e.g. "04", "05", "06")
     */
    get month() {
        let currentMonth = this.element(globals_1.by.model('currentMonth'));
        return this.isOpen().then(isOpen => {
            this.open(); // you have to in order to get to the dropdown
            return rxSelect.initialize(currentMonth).selectedOption.getText().then(month => {
                // if datepicker was closed before starting, put it back
                if (!isOpen) {
                    this.close();
                }
                return moment(`${month} 2000`, 'MMM YYYY').format('MM');
            });
        });
    }
    set month(value) {
        this.open();
        let dropdownExpectedValue = moment(`2000-${value}`, 'YYYY-MM').format('MMM');
        if (dropdownExpectedValue === 'Invalid date') {
            throw new Error(`Unexpected month value for month number "${value}". Months are not zero-indexed!`);
        }
        let slowClick = false;
        rxSelect.initialize(this.element(globals_1.by.model('currentMonth'))).select(dropdownExpectedValue, slowClick);
    }
    /**
     * @private
     * @type {String}
     * @description (get/set) Year value of the picker _calendar_.
     *
     * The date picker provides a 10-year range before and after the selected date,
     * if present.  Otherwise, the range is calculated from today's date.
     *
     * **Format:** `YYYY` (e.g. "2016")
     */
    get year() {
        return this.isOpen().then(isOpen => {
            this.open(); // you have to in order to get to the dropdown
            let year = rxSelect.initialize(this.element(globals_1.by.model('currentYear'))).selectedOption.getText();
            // if datepicker was closed before starting, put it back
            if (!isOpen) {
                this.close();
            }
            return year;
        });
    }
    set year(value) {
        this.open();
        let slowClick = false;
        rxSelect.initialize(this.element(globals_1.by.model('currentYear'))).select(value, slowClick);
    }
    /**
     * @type {String}
     * @description (get/set) _Selected value_ of the picker.
     *
     * **Format:** `YYYY-MM-DD` (e.g. "2016-05-25")
     * @example
     * let datepicker = new encore.rxDatePicker();
     * datepicker.date = '2016-01-01';
     * expect(datepicker.date).to.eventually.equal('2016-01-01');
     */
    get date() {
        return this.$('.displayValue').getAttribute('datetime');
    }
    set date(dateString) {
        let date = moment(dateString, 'YYYY-MM-DD');
        this.month = date.format('MM');
        this.year = date.format('YYYY');
        this._selectVisibleDate(dateString);
    }
    /**
     * @private
     * @description
     * Sets the calendar's date by clicking the date corresponding to the value of
     * `date`.
     *
     * @param {String} date
     * `YYYY-MM-DD` formatted string to select on the current month.
     *
     * @example
     * let picker = new rxDatePicker();
     * picker._selectVisibleDate('2014-05-13');
     * expect(picker.date).to.eventually.eq('2014-05-13');
     */
    _selectVisibleDate(date) {
        this.open();
        return this._dateElementByDate(date).$('span').click();
    }
    ;
    /**
     * @private
     * @deprecated Now that datepickers return strings, this complicated logic is not needed.
     * @description
     * Will select the last day of the current month seen on the picker calendar.
     * Does not accept arguments. Set the calendar month yourself with
     * {@link rxDatePicker#month} and {@link rxDatePicker#year} first, so that logic
     * picks the correct date.
     */
    _selectLastDayOfCurrentMonth() {
        this.open();
        return globals_1.protractor.promise.all([
            this.month,
            this.year,
        ]).then(results => {
            let month = results[0];
            let year = results[1];
            let formattedDate = `${year}-${month}`;
            let lastOfMonth = moment(formattedDate, 'YYYY-MM').endOf('month');
            return this._selectVisibleDate(lastOfMonth.format('YYYY-MM-DD'));
        });
    }
    ;
    /**
     * @private
     * @description
     * Return a day seen on the picker calendar that corresponds to the value of
     * `date`.
     *
     * @param {String} date
     * `YYYY-MM-DD` formatted string of the date to select.
     *
     * @example
     * let picker = new encore.rxDatePicker();
     * picker.open();
     * picker._dateElementByDate('2012-06-23').getAttribute('class');
     *
     * @returns {ElementFinder}
     */
    _dateElementByDate(date) {
        return this.$(`[data-date="${date}"]`);
    }
    ;
    /**
     * @see rxDatePicker#close
     * @description Ensures that the date picker is open.
     * @example
     * let picker = new encore.rxDatePicker();
     * picker.open();
     * picker.open(); // does nothing
     */
    open() {
        return this.isOpen().then((open) => {
            if (!open) {
                return this.$('.control').click();
            }
        });
    }
    ;
    /**
     * @see rxDatePicker#open
     * @description Ensures that the date picker is closed.
     * @example
     * let picker = new encore.rxDatePicker();
     * picker.open();
     * picker.close();
     * picker.close(); // does nothing
     */
    close() {
        return this.isOpen().then((isOpen) => {
            if (isOpen) {
                return this.$('.control').click();
            }
        });
    }
    ;
    /**
     * @private
     * @description Click over to the next month in the calendar.
     */
    nextMonth() {
        this.open();
        return this.$('.arrow.next').click();
    }
    ;
    /**
     * @private
     * @description Click back to the previous month in the calendar.
     */
    previousMonth() {
        this.open();
        return this.$('.arrow.prev').click();
    }
    ;
    /**
     * @description Whether or not the date requested is currently selected.
     * @param {String} date
     * `YYYY-MM-DD` formatted date to check if it is currently selected.
     * @returns {Promise&lt;Boolean>}
     */
    isDateSelected(date) {
        this.open();
        return this._dateElementByDate(date).getAttribute('class')
            .then(classes => _.includes(classes, 'selected'));
    }
    ;
    /**
     * @private
     * @description
     * Whether or not the date passed in matches the "today" date in the calendar.
     * @param {String} date
     * `YYYY-MM-DD` formatted date to check if it is styled as today's date.
     * @returns {Promise&lt;Boolean>}
     */
    isDateToday(date) {
        this.open();
        return this._dateElementByDate(date).getAttribute('class')
            .then(classes => _.includes(classes, 'today'));
    }
    ;
    /**
     * @description Whether or not the calendar is in an invalid state.
     * @returns {Promise&lt;Boolean>}
     */
    isValid() {
        return this.getAttribute('class')
            .then(classes => !_.includes(classes, 'ng-invalid'));
    }
    ;
    /**
     * @description Whether or not the calendar is open.
     * @returns {Promise&lt;Boolean>}
     */
    isOpen() {
        return this.$('.popup').getAttribute('class')
            .then(classes => !_.includes(classes, 'ng-hide'));
    }
    ;
    /**
     * @param {ElementFinder} rxDatePickerElement
     * @deprecated Prefer use of `new` constructor. Will be removed at version 3.0.
     * ElementFinder to be transformed into an rxDatePicker page object.
     * @returns {rxDatePicker} Page object representing the rxDatePicker element.
     */
    static initialize(rxDatePickerElement) {
        return new rxDatePicker(rxDatePickerElement);
    }
    ;
}
exports.rxDatePicker = rxDatePicker;
;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-exercise_rxBulkSelect.html">exercise/rxBulkSelect</a></li><li><a href="module-exercise_rxCharacterCount.html">exercise/rxCharacterCount</a></li><li><a href="module-exercise_rxCheckbox.html">exercise/rxCheckbox</a></li><li><a href="module-exercise_rxCollapse.html">exercise/rxCollapse</a></li><li><a href="module-exercise_rxCopy.html">exercise/rxCopy</a></li><li><a href="module-exercise_rxDatePicker.html">exercise/rxDatePicker</a></li><li><a href="module-exercise_rxFieldName.html">exercise/rxFieldName</a></li><li><a href="module-exercise_rxMetadata.html">exercise/rxMetadata</a></li><li><a href="module-exercise_rxMultiSelect.html">exercise/rxMultiSelect</a></li><li><a href="module-exercise_rxOptionTable.html">exercise/rxOptionTable</a></li><li><a href="module-exercise_rxPaginate.html">exercise/rxPaginate</a></li><li><a href="module-exercise_rxRadio.html">exercise/rxRadio</a></li><li><a href="module-exercise_rxSearchBox.html">exercise/rxSearchBox</a></li><li><a href="module-exercise_rxSelect.html">exercise/rxSelect</a></li><li><a href="module-exercise_rxTags.html">exercise/rxTags</a></li><li><a href="module-exercise_rxToggleSwitch.html">exercise/rxToggleSwitch</a></li></ul><h3>Classes</h3><ul><li><a href="rxCopy.html">rxCopy</a></li><li><a href="rxDatePicker.html">rxDatePicker</a></li><li><a href="rxFieldName.html">rxFieldName</a></li><li><a href="rxTimePicker.html">rxTimePicker</a></li><li><a href="Tooltip.html">Tooltip</a></li></ul><h3>Namespaces</h3><ul><li><a href="rxAccountInfo.html">rxAccountInfo</a></li><li><a href="rxAccountInfo.badge.html">rxAccountInfo.badge</a></li><li><a href="rxActionMenu.html">rxActionMenu</a></li><li><a href="rxActionMenu.action.html">rxActionMenu.action</a></li><li><a href="rxAge.html">rxAge</a></li><li><a href="rxApp.html">rxApp</a></li><li><a href="rxBreadcrumbs.html">rxBreadcrumbs</a></li><li><a href="rxBreadcrumbs.breadcrumb.html">rxBreadcrumbs.breadcrumb</a></li><li><a href="rxBulkSelect.html">rxBulkSelect</a></li><li><a href="rxButton.html">rxButton</a></li><li><a href="rxCharacterCount.html">rxCharacterCount</a></li><li><a href="rxCheckbox.html">rxCheckbox</a></li><li><a href="rxCollapse.html">rxCollapse</a></li><li><a href="rxDiskSize.html">rxDiskSize</a></li><li><a href="rxEnvironment.html">rxEnvironment</a></li><li><a href="rxFeedback.html">rxFeedback</a></li><li><a href="rxForm.html">rxForm</a></li><li><a href="rxForm.textField.html">rxForm.textField</a></li><li><a href="rxInfoPanel.html">rxInfoPanel</a></li><li><a href="rxLocalStorage.html">rxLocalStorage</a></li><li><a href="rxMetadata.html">rxMetadata</a></li><li><a href="rxMisc.html">rxMisc</a></li><li><a href="rxModalAction.html">rxModalAction</a></li><li><a href="rxMultiSelect.html">rxMultiSelect</a></li><li><a href="rxNotify.html">rxNotify</a></li><li><a href="rxNotify.notification.html">rxNotify.notification</a></li><li><a href="rxOptionTable.html">rxOptionTable</a></li><li><a href="rxOptionTable.row.html">rxOptionTable.row</a></li><li><a href="rxPage.html">rxPage</a></li><li><a href="rxPaginate.html">rxPaginate</a></li><li><a href="rxPaginate.shownItems.html">rxPaginate.shownItems</a></li><li><a href="rxRadio.html">rxRadio</a></li><li><a href="rxSearchBox.html">rxSearchBox</a></li><li><a href="rxSelect.html">rxSelect</a></li><li><a href="rxSelect.option.html">rxSelect.option</a></li><li><a href="rxSelectFilter.html">rxSelectFilter</a></li><li><a href="rxSortableColumn.html">rxSortableColumn</a></li><li><a href="rxSortableColumns.html">rxSortableColumns</a></li><li><a href="rxStatusColumn.html">rxStatusColumn</a></li><li><a href="rxTags.html">rxTags</a></li><li><a href="rxTags.tag.html">rxTags.tag</a></li><li><a href="rxToggleSwitch.html">rxToggleSwitch</a></li><li><a href="tabs.html">tabs</a></li><li><a href="tabs.tab.html">tabs.tab</a></li></ul><h3>Global</h3><ul><li><a href="global.html#rxSpinner">rxSpinner</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Wed Mar 29 2017 15:01:08 GMT-0500 (CDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
